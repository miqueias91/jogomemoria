<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
<HEAD>
<META NAME="description" content="Memory is a PC-Game, which is a part of the '7 by one stroke' package, translated from C++ into HTML and JavaScript">
<META NAME="author" content="Lutz Tautenhahn">
<META NAME="keywords" content="Game, Memory, Streich, Stroke, JavaScript">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title>Memory</title>
<script language="JavaScript">
var l, n, m, I_S, IsOver, MaxS, StartTime, EndTime, MaxX=6, MaxY=4, S_New=2;
Series = new Array(4);
for (l=0; l < 4; l++)
{ Series[l]=new Array(2); 
} 
Symbol = new Array(MaxX);
for (n=0; n < MaxX; n++)
{ Symbol[n]=new Array(MaxY); 
} 
IsSolved = new Array(MaxX);
for (n=0; n < MaxX; n++)
{ IsSolved[n]=new Array(MaxY); 
} 
PicNum = new Array(30);
Pic = new Array(31);
for (l=0; l < 31; l++)
{ Pic[l] = new Image(); 
  Pic[l].src = "memo"+eval(l)+".gif"; 
} 

function SetSeriesLen(ll)
{ S_New=ll;
  Scramble();
} 

function Clicked(nn, mm)
{ if (Pressed(nn, mm))
    RefreshScreen();
} 

function Show()
{ if (IsOver)
    alert("Tudo é certo.");
  else
  { for (n=0; n < MaxX; n++)
    { for (m=0; m < MaxY; m++) 
        IsSolved[n][m]=true;
    }
    RefreshScreen();
    alert("Mostrar não é resolver !");
    IsOver=true;
  }
}
  
function Scramble()
{ var ll;
  var nn;
  var mm;
  MaxS=S_New;
  for (l=0; l<30; l++)
    PicNum[l]=l;
  for (ll=0; ll<108; ll++)
  { n=Math.round(Math.random()*100)%30;
    m=Math.round(Math.random()*100)%30;
    l=PicNum[n];
    PicNum[n]=PicNum[m];
    PicNum[m]=l;
  }
  l=0;
  for (n=0; n<MaxX; n++)
  { for (m=0; m<MaxY; m++)
    { IsSolved[n][m]=false;
      Symbol[n][m]=l % (MaxX*MaxY/MaxS);
      l++;
    }
  }
  for (l=0; l<1080; l++)
  { n=Math.round(Math.random()*100)%MaxX;
    m=Math.round(Math.random()*100)%MaxY;
    nn=Math.round(Math.random()*100)%MaxX;
    mm=Math.round(Math.random()*100)%MaxY;
    ll=Symbol[n][m];
    Symbol[n][m]=Symbol[nn][mm];
    Symbol[nn][mm]=ll;
  }  
  I_S=0;
  Moves=0;
  IsOver=false;
  RefreshScreen();  
  Now = new Date();
  StartTime = Now.getTime() / 1000;
}

function Pressed(nn, mm)
{ if (IsOver)  return(false);
  if (IsSolved[nn][mm]) return(false);
  for (l=0; l<I_S; l++)
  { if ((Series[l][0]==nn)&&(Series[l][1]==mm))
      return(false);
  }
  l=Symbol[nn][mm];
  if (I_S==0)
  { Series[0][0]=nn;
    Series[0][1]=mm;
    I_S=1;
  }
  else
  { if (Symbol[Series[0][0]][Series[0][1]]!=l)
    { Series[0][0]=nn;
      Series[0][1]=mm;
      I_S=1;
    }
    else
    { Series[I_S][0]=nn;
      Series[I_S][1]=mm;
      I_S++;
    }
  }
  if (I_S==MaxS)
  { for (l=0; l<I_S; l++)
      IsSolved[Series[l][0]][Series[l][1]]=true;
    I_S=0;
    IsOver=true;
    for (n=0; n<MaxX; n++)
    { for (m=0; m<MaxY; m++)
      { if (! IsSolved[n][m])
          IsOver=false;
      }
    }
  }
  Moves++;
  return(true);
}

function RefreshScreen()
{ var ll;
  for (m=0; m < MaxY; m++)
  { for (n=0; n < MaxX; n++) 
    { if (IsSolved[n][m])
        l=PicNum[Symbol[n][m]]+1;
      else l=0;
      for (ll=0; ll<I_S; ll++)
      { if ((Series[ll][0]==n)&&(Series[ll][1]==m))
        { l=PicNum[Symbol[n][m]]+1;
        }
      }
      window.document.images[MaxX*m+n].src = Pic[l].src;
    }     
  }
  if (IsOver) 
  { Now = new Date();
    EndTime = Now.getTime() / 1000;
    ll=Math.floor(EndTime - StartTime);
    if (window.opener)
    { if (window.opener.SetHighscores)
        window.opener.SetHighscores("Memory",S_New+" pics",ll,-1);
    }
    alert("Valeu, você resolveu este jogo com "+Moves+" lances em "+ll+" segundos !");
  }
}

function Help()
{ alert("Memory é um jogo bem conhecido. Há diversos quadrados com"+
      "\nimagens que todos são cobertas no começo. Há sempre"+
      "\nalguns quadrados com a mesma imagem. Quando você estala"+
      "\nsobre os quadrados com as mesmas imagens, um depois que o"+
      "\noutro, então as imagens permanecerão descobertas, se não"+
      "\nsomente a última imagem selecionada permanece descoberta."+
      "\nO jogo é resolvido quando todas as imagens são visíveis."+
      "\nBoa sorte!"); 
}
</script>
</head>
<BODY bgcolor=#FFCC00>
<form>
<DIV ALIGN=center>
<table border cellpadding=0 cellspacing=0 bgcolor=#FFFFFF>
<script language="JavaScript">
document.open("text/plain");
for (n=0; n < MaxY; n++)
{ document.writeln("<tr align=center>");
  for (m=0; m < MaxX; m++)
    document.writeln("<td><IMG src=\"memo0.gif\" border=0 onMouseDown=\"javascript:Clicked("+m+","+n+")\"></td>");
  document.writeln("</tr>");
}
document.close();
</script>
</table>
<br>
<table noborder>
  <tr>
    <td align=center><table border cellpadding=4 cellspacing=0>
        <tr><td><input type=radio name="Serien" checked value="2" onClick="javascript:SetSeriesLen(2)">2 imagens iguais</td></tr>
        <tr><td><input type=radio name="Serien" value="3" onClick="javascript:SetSeriesLen(3)">3 imagens iguais</td></tr>
        <tr><td><input type=radio name="Serien" value="4" onClick="javascript:SetSeriesLen(4)">4 imagens iguais</td></tr>
        </table>
    </td>
    <td>&nbsp;
    </td>
    <td align=center><table noborder>
        <tr><td><input type=button value="Novo Jogo" width=98 style="width:98" onClick="javascript:Scramble()"></td></tr>
        <tr><td><input type=button value="Mostrar" width=98 style="width:98" onClick="javascript:Show()"></td></tr>
        <tr><td><input type=button value="Ajuda" width=98 style="width:98" onClick="javascript:Help()"></td></tr>
        </table>
    </td>
  </tr>
</table>
</DIV>
</form>
<script language="JavaScript">
  Scramble();
</script>
</BODY>
</HTML>
